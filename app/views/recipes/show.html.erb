<section id="recipe" class="content">

<h1 class="recipe"><%= @recipe.name  %></h1>

<!-- image -->
<div 
	id="recipe_picture"
	style="background-image: url(<%= @recipe.image_url %>);" 
>




</div>


<!-- times -->
<div id="times">

	<div style="background-image:url(/assets/images/time/cooking.svg)" >
		<!-- préparation  -->
		<time><%= @recipe.t_cooking  %></time>
	</div>
	<div style="background-image:url(/assets/images/time/baking.svg)" >
		<!-- cuisson -->
		<time><%= @recipe.t_baking %></time>
	</div>
	<div style="background-image:url(/assets/images/time/cooling.svg)" >
		<!-- réfrigération -->
		<time><%= @recipe.t_cooling  %> </time>
	</div>
	<div style="background-image:url(/assets/images/time/rest.svg)" >
		<!-- repos -->
		<time><%= @recipe.t_rest %></time>
	</div>
</div>



<ul class="actions" >

	<!-- here you can vote for this recipe and add like -->
	<li id="vote">
		<!--  AJAX links to vote up / down on this recipe -->
		<%= link_to '', recipes_vote_path(id: @recipe.id, value: 1) , id: 'vote_up', title: 'Cette recette vaut vraiment le coup',  remote: true %>
		<span id="recipe_note"><%= @recipe.note %></span>
		<%= link_to '', recipes_vote_path(id: @recipe.id, value: -1) , id: 'vote_down', title: 'Ce n\'était pas si bon que ca :(',  remote: true %>
	</li>

	<li><%= link_to "sauvegarder", recipes_save_path( :id => @recipe.id) , :class => 'button_save' %></li>

	<!-- Add a fork button if the user is connected -->
	<% if current_user %>
		<li><%= link_to "créer une variante" , recipes_fork_path( :id => @recipe.id) , :class => 'button_edit' %></li>
	<% end %>

	<!-- if it's the owner of the recipe  -->
	<% if current_user == @recipe.user %>

		<li><%= link_to "modifier" , edit_recipe_path , 
					:class => 'button_edit'%></li>

		<li><%= link_to "supprimer" , @recipe ,
					:class => 'button_delete',
					:method => :delete, 
					:confirm => 'Are you sure?' ,
					:title => "Delete #{@recipe.name}" %></li>
	<% end %>

</ul>

<% if @recipe.ingredients %>
	<ul id="ingredients">
		<% @recipe.ingredients.each_line do |ingredient|%>
			<li><%= link_to ingredient , recipes_search_path( :ingredients => ingredient )  %></li>
		<% end %>
	</ul>
<% end %>

<% if @recipe.steps %>
	<ul id="steps">
		<% @recipe.steps.each_line do |step|%>
			<li><span></span><%= step %></li>
		<% end %>
	</ul>
<% end %>




<%= render 'shared/user' , :user => @recipe.user %>

<%= render 'shared/comments', :comments => @recipe .comments %>

</section>


<script type="text/javascript">
	$(document).ready(function(){
		$('#recipe_picture').parallax();

		// set green color on vote button if the current user already voted 
		<% begin %>
			<% if Vote.where( user_id: current_user.id , recipe_id: params[:id] , value: 1).first %>
				$('#vote_up').css('color' , 'green');
			<% elsif Vote.where( user_id: current_user.id , recipe_id: params[:id] , value: -1).first %>
				$('#vote_down').css('color' , 'green');
			<% end %>
		<% rescue NoMethodError %>
			
		<% end %>


	});
</script>


